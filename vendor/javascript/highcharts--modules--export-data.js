var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var t={};(function(e){t?(e.default=e,t=e):e("undefined"!==typeof Highcharts?Highcharts:void 0)})((function(t){function p(e,t,a,n){e.hasOwnProperty(t)||(e[t]=n.apply(null,a),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t=t?t._modules:{};p(t,"Extensions/ExportData/ExportDataDefaults.js",[],(function(){return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}}));p(t,"Extensions/DownloadURL.js",[t["Core/Globals.js"]],(function(e){var t=e.isSafari,a=e.win,n=a.document,o=a.URL||a.webkitURL||a,i=e.dataURLtoBlob=function(e){if((e=e.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<e.length&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&a.Blob&&o.createObjectURL){var t=a.atob(e[3]),n=new a.ArrayBuffer(t.length);n=new a.Uint8Array(n);for(var i=0;i<n.length;++i)n[i]=t.charCodeAt(i);e=new a.Blob([n],{type:e[1]});return o.createObjectURL(e)}};e=e.downloadURL=function(e,o){var r=a.navigator,s=n.createElement("a");if("string"===typeof e||e instanceof String||!r.msSaveOrOpenBlob){e="".concat(e);r=/Edge\/\d+/.test(r.userAgent);if((t&&"string"===typeof e&&0===e.indexOf("data:application/pdf")||r||2e6<e.length)&&(e=i(e)||"",!e))throw Error("Failed to convert to blob");if("undefined"!==typeof s.download)s.href=e,s.download=o,n.body.appendChild(s),s.click(),n.body.removeChild(s);else try{var l=a.open(e,"chart");if("undefined"===typeof l||null===l)throw Error("Failed to open window")}catch(t){a.location.href=e}}else r.msSaveOrOpenBlob(e,o)};return{dataURLtoBlob:i,downloadURL:e}}));p(t,"Extensions/ExportData/ExportData.js",[t["Core/Renderer/HTML/AST.js"],t["Extensions/ExportData/ExportDataDefaults.js"],t["Core/Globals.js"],t["Core/Defaults.js"],t["Extensions/DownloadURL.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(t,a,n,o,i,r,s){function f(){var e=this.getCSV(!0);x(S(e,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(e),this.getFilename()+".csv")}function v(){var e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";x(S(e,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+d.btoa(unescape(encodeURIComponent(e))),this.getFilename()+".xls")}function q(t){var a="",n=this.getDataRows(),o=(this||e).options.exporting.csv,i=H(o.decimalPoint,","!==o.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),r=H(o.itemDelimiter,","===i?";":","),s=o.lineDelimiter;n.forEach((function(e,t){for(var o,l=e.length;l--;)o=e[l],"string"===typeof o&&(o='"'+o+'"'),"number"===typeof o&&"."!==i&&(o=o.toString().replace(".",i)),e[l]=o;e.length=n.length?n[0].length:0;a+=e.join(r);t<n.length-1&&(a+=s)}));return a}function D(t){var a,n=(this||e).hasParallelCoordinates,o=(this||e).time,i=(this||e).options.exporting&&(this||e).options.exporting.csv||{},r=(this||e).xAxis,s={},c=[],d=[],h=[],u=(this||e).options.lang.exportData,x=u.categoryHeader,w=u.categoryDatetimeHeader,v=function(e,a,n){if(i.columnHeaderFormatter){var o=i.columnHeaderFormatter(e,a,n);if(!1!==o)return o}return e?e instanceof y?t?{columnTitle:1<n?a:e.name,topLevelColumnTitle:e.name}:e.name+(1<n?" ("+a+")":""):e.options.title&&e.options.title.text||(e.dateTime?w:x):x},T=function(e,t,a){var n={},o={};t.forEach((function(t){var i=(e.keyToAxis&&e.keyToAxis[t]||t)+"Axis";i=j(a)?e.chart[i][a]:e[i];n[t]=i&&i.categories||[];o[t]=i&&i.dateTime}));return{categoryMap:n,dateTimeValueAxisMap:o}},Z=function(e,t){return e.data.filter((function(e){return"undefined"!==typeof e.y&&e.name})).length&&t&&!t.categories&&!e.keyToAxis?e.pointArrayMap&&e.pointArrayMap.filter((function(e){return"x"===e})).length?(e.pointArrayMap.unshift("x"),e.pointArrayMap):["x","y"]:e.pointArrayMap||["y"]},E=[],C=0;(this||e).series.forEach((function(e){var c,u=e.xAxis,x=e.options.keys||Z(e,u),y=x.length,w=!e.requireSorting&&{},A=r.indexOf(u),O=T(e,x);if(!1!==e.options.includeInDataExport&&!e.options.isInternal&&!1!==e.visible){N(E,(function(e){return e[0]===A}))||E.push([A,C]);for(c=0;c<y;)a=v(e,x[c],x.length),h.push(a.columnTitle||a),t&&d.push(a.topLevelColumnTitle||a),c++;var L={chart:e.chart,autoIncrement:e.autoIncrement,options:e.options,pointArrayMap:e.pointArrayMap,index:e.index};e.options.data.forEach((function(t,a){var r={series:L};n&&(O=T(e,x,a));e.pointClass.prototype.applyOptions.apply(r,[t]);var d=r.x;k(s[d])&&s[d].seriesIndices.includes(L.index)&&(t=Object.keys(s).filter((function(e){return s[e].seriesIndices.includes(L.index)&&d})).filter((function(e){return 0===e.indexOf(String(d))})),d=d.toString()+","+t.length);t=e.data[a]&&e.data[a].name;c=0;(!u||"name"===e.exportKey||!n&&u&&u.hasNames&&t)&&(d=t);w&&(w[d]&&(d+="|"+a),w[d]=!0);s[d]||(s[d]=[],s[d].xValues=[]);s[d].x=r.x;s[d].name=t;s[d].xValues[A]=r.x;k(s[d].seriesIndices)||(s[d].seriesIndices=[]);for(s[d].seriesIndices=l(l([],s[d].seriesIndices,!0),[L.index],!1);c<y;)a=x[c],t=r[a],s[d][C+c]=H(O.categoryMap[a][t],O.dateTimeValueAxisMap[a]?o.dateFormat(i.dateFormat,t):null,t),c++}));C+=c}}));for(R in s)Object.hasOwnProperty.call(s,R)&&c.push(s[R]);u=t?[d,h]:[h];for(C=E.length;C--;){var A=E[C][0];var O=E[C][1];var L=r[A];c.sort((function(e,t){return e.xValues[A]-t.xValues[A]}));var R=v(L);u[0].splice(O,0,R);t&&u[1]&&u[1].splice(O,0,R);c.forEach((function(e){var t=e.name;L&&!k(t)&&(L.dateTime?(e.x instanceof Date&&(e.x=e.x.getTime()),t=o.dateFormat(i.dateFormat,e.x)):t=L.categories?H(L.names[e.x],L.categories[e.x],e.x):e.x);e.splice(O,0,t)}))}u=u.concat(c);M(this||e,"exportData",{dataRows:u});return u}function Q(e){var b=function(e){if(!e.tagName||"#text"===e.tagName)return e.textContent||"";var t=e.attributes,a="<".concat(e.tagName);t&&Object.keys(t).forEach((function(e){var n=t[e];a+=" ".concat(e,'="').concat(n,'"')}));a+=">";a+=e.textContent||"";(e.children||[]).forEach((function(e){a+=b(e)}));return a+="</".concat(e.tagName,">")};e=this.getTableAST(e);return b(e)}function ba(t){var a=0,n=[],o=(this||e).options,i=t?1.1.toLocaleString()[1]:".",r=H(o.exporting.useMultiLevelHeaders,!0);t=this.getDataRows(r);var s=r?t.shift():null,l=t.shift(),m=function(e,t,a,n){var o=H(n,"");t="highcharts-text"+(t?" "+t:"");"number"===typeof o?(o=o.toString(),","===i&&(o=o.replace(".",i)),t="highcharts-number"):n||(t="highcharts-empty");a=R({class:t},a);return{tagName:e,attributes:a,textContent:o}};!1!==o.exporting.tableCaption&&n.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:H(o.exporting.tableCaption,o.title.text?o.title.text:"Chart")});for(var c=0,d=t.length;c<d;++c)t[c].length>a&&(a=t[c].length);n.push(function(e,t,a){var n=[],i=0;a=a||t&&t.length;var s,l=0;if(s=r&&e&&t){e:if(s=e.length,t.length===s){for(;s--;)if(e[s]!==t[s]){s=!1;break e}s=!0}else s=!1;s=!s}if(s){for(s=[];i<a;++i){var c=e[i];var d=e[i+1];c===d?++l:l?(s.push(m("th","highcharts-table-topheading",{scope:"col",colspan:l+1},c)),l=0):(c===t[i]?o.exporting.useRowspanHeaders?(d=2,delete t[i]):(d=1,t[i]=""):d=1,c=m("th","highcharts-table-topheading",{scope:"col"},c),1<d&&c.attributes&&(c.attributes.valign="top",c.attributes.rowspan=d),s.push(c))}n.push({tagName:"tr",children:s})}if(t){s=[];i=0;for(a=t.length;i<a;++i)"undefined"!==typeof t[i]&&s.push(m("th",null,{scope:"col"},t[i]));n.push({tagName:"tr",children:s})}return{tagName:"thead",children:n}}(s,l,Math.max(a,l.length)));var h=[];t.forEach((function(e){for(var t=[],n=0;n<a;n++)t.push(m(n?"td":"th",null,n?{}:{scope:"row"},e[n]));h.push({tagName:"tr",children:t})}));n.push({tagName:"tbody",children:h});n={tree:{tagName:"table",id:"highcharts-data-table-".concat((this||e).index),children:n}};M(this||e,"aftergetTableAST",n);return n.tree}function ca(){this.toggleDataTable(!1)}function da(a){var n=(a=H(a,!(this||e).isDataTableVisible))&&!(this||e).dataTableDiv;n&&((this||e).dataTableDiv=c.createElement("div"),(this||e).dataTableDiv.className="highcharts-data-table",(this||e).renderTo.parentNode.insertBefore((this||e).dataTableDiv,(this||e).renderTo.nextSibling));if((this||e).dataTableDiv){var o=(this||e).dataTableDiv.style,i=o.display;o.display=a?"block":"none";a&&((this||e).dataTableDiv.innerHTML=t.emptyHTML,new t([this.getTableAST()]).addToDOM((this||e).dataTableDiv),M(this||e,"afterViewData",{element:(this||e).dataTableDiv,wasHidden:n||i!==o.display}))}(this||e).isDataTableVisible=a;n=(this||e).exportDivElements;i=(o=(this||e).options.exporting)&&o.buttons&&o.buttons.contextButton.menuItems;a=(this||e).options.lang;o&&o.menuItemDefinitions&&a&&a.viewData&&a.hideData&&i&&n&&(n=n[i.indexOf("viewData")])&&t.setElementHTML(n,(this||e).isDataTableVisible?a.hideData:a.viewData)}function fa(){this.toggleDataTable(!0)}function S(e,t){var a=d.navigator,n=-1<a.userAgent.indexOf("WebKit")&&0>a.userAgent.indexOf("Chrome"),o=d.URL||d.webkitURL||d;try{if(a.msSaveOrOpenBlob&&d.MSBlobBuilder){var i=new d.MSBlobBuilder;i.append(e);return i.getBlob("image/svg+xml")}if(!n)return o.createObjectURL(new d.Blob(["\ufeff"+e],{type:t}))}catch(e){}}function ha(){var t=this||e,a=t.dataTableDiv,g=function(e,t){return function(a,n){var o=(t?a:n).children[e].textContent;a=(t?n:a).children[e].textContent;return""===o||""===a||isNaN(o)||isNaN(a)?o.toString().localeCompare(a):o-a}};if(a&&t.options.exporting&&t.options.exporting.allowTableSorting){var n=a.querySelector("thead tr");n&&n.childNodes.forEach((function(e){var n=e.closest("table");e.addEventListener("click",(function(){var o=l([],a.querySelectorAll("tr:not(thead tr)"),!0),i=l([],e.parentNode.children,!0);o.sort(g(i.indexOf(e),t.ascendingOrderInTable=!t.ascendingOrderInTable)).forEach((function(e){n.appendChild(e)}));i.forEach((function(e){["highcharts-sort-ascending","highcharts-sort-descending"].forEach((function(t){e.classList.contains(t)&&e.classList.remove(t)}))}));e.classList.add(t.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")}))}))}}function ia(){(this||e).options&&(this||e).options.exporting&&(this||e).options.exporting.showTable&&!(this||e).options.chart.forExport&&this.viewData()}var l=(this||e)&&(this||e).__spreadArray||function(e,t,a){if(a||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},c=n.doc,d=n.win,h=o.getOptions,u=o.setOptions,x=i.downloadURL,y=r.series;n=r.seriesTypes;var w=n.arearange,E=n.gantt,C=n.map,A=n.mapbubble,O=n.treemap,L=s.addEvent,k=s.defined,R=s.extend,N=s.find,M=s.fireEvent,j=s.isNumber,H=s.pick,I=[];"";return{compose:function(e){-1===I.indexOf(e)&&(I.push(e),L(e,"afterViewData",ha),L(e,"render",ia),e=e.prototype,e.downloadCSV=f,e.downloadXLS=v,e.getCSV=q,e.getDataRows=D,e.getTable=Q,e.getTableAST=ba,e.hideData=ca,e.toggleDataTable=da,e.viewData=fa);if(-1===I.indexOf(u)){I.push(u);(e=h().exporting)&&(R(e.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),e.buttons&&e.buttons.contextButton.menuItems&&e.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData"));u(a)}w&&-1===I.indexOf(w)&&(I.push(w),w.prototype.keyToAxis={low:"y",high:"y"});E&&-1===I.indexOf(E)&&(I.push(E),E.prototype.keyToAxis={start:"x",end:"x"});C&&-1===I.indexOf(C)&&(I.push(C),C.prototype.exportKey="name");A&&-1===I.indexOf(A)&&(I.push(A),A.prototype.exportKey="name");O&&-1===I.indexOf(O)&&(I.push(O),O.prototype.exportKey="name")}}}));p(t,"masters/modules/export-data.src.js",[t["Core/Globals.js"],t["Extensions/ExportData/ExportData.js"]],(function(e,t){t.compose(e.Chart)}))}));var a=t;export{a as default};

